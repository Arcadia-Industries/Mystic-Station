using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Console;
using Robust.Shared.Input;

using static Content.Replay.Manager.ReplayManager;

namespace Content.Replay.UI.TimeWidget;

[GenerateTypedNameReferences]
public sealed partial class TimeControlBox : UIWidget
{
    public TimeControlBox()
    {
        RobustXamlLoader.Load(this);

        var con = IoCManager.Resolve<IConsoleHost>();

        PlayButton.OnToggled += (args) => con.ExecuteCommand(ToggleCommand);
        ResetButton.OnPressed += (args) => con.ExecuteCommand($"{SetCommand} 0");
        ForwardButton.OnPressed += (args) => con.ExecuteCommand($"{SkipCommand} 1");
        RewindButton.OnPressed += (args) => con.ExecuteCommand($"{SkipCommand} -1");
        ForwardFiveButton.OnPressed += (args) => con.ExecuteCommand($"{SkipCommand} 5");
        RewindFiveButton.OnPressed += (args) => con.ExecuteCommand($"{SkipCommand} -5");
        StopButton.OnPressed += (args) => con.ExecuteCommand(StopCommand);

        TickSlider.OnKeyBindUp += (args) =>
        {
            if (args.Function == EngineKeyFunctions.Use)
                con.ExecuteCommand($"{SetCommand} {TickSlider.Value}");
        };
    }
}
