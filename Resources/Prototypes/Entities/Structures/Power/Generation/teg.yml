- type: entity
  id: TegCenter
  name: thermo-electric generator
  placement:
    mode: SnapgridCenter
  components:
    - type: Clickable
    - type: InteractionOutline
    - type: Physics
      bodyType: Static
    - type: Fixtures
      fixtures:
        fix1:
          shape:
            !type:PhysShapeAabb
            bounds: "-0.45,-0.45,0.45,0.45"
          density: 190
          mask:
            - MachineMask
          layer:
            - MachineLayer
    - type: Sprite
      sprite: Structures/Power/Generation/teg.rsi
      state: teg
    - type: Anchorable
    - type: Pullable
    - type: NodeContainer
      examinable: true
      nodes:
        output:
          !type:CableDeviceNode
          nodeGroupID: HVPower
        teg:
          !type:TegNodeGenerator
          nodeGroupID: Teg
    - type: Rotatable

    # Note that only the TEG center is an AtmosDevice.
    # It fires processing on behalf of its connected circulators.
    - type: AtmosDevice
    - type: TegGenerator

    - type: DeviceNetwork
      deviceNetId: AtmosDevices
      receiveFrequencyId: AtmosMonitor
      transmitFrequencyId: AtmosMonitor
      prefix: device-address-prefix-teg
      sendBroadcastAttemptEvent: true
      examinableAddress: true
    - type: WiredNetworkConnection

    # The TEG stores power in an internal buffer to output it over the wire.
    - type: Battery
      maxCharge: 1000000
      startingCharge: 0
    - type: BatteryDischarger
    - type: PowerNetworkBattery
      # Just needs to be REALLY BIG! This would just be a hard-cap on the TEG output.
      # TODO: Revise this!
      maxSupply: 100000000000
      SupplyRampTolerance: 100000000

- type: entity
  id: TegCirculator
  name: circulator
  placement:
    mode: SnapgridCenter
  components:
    # visuals
    - type: Sprite
      sprite: Structures/Power/Generation/teg.rsi
      layers:
        - state: circ-p
    # tags
    - type: Tag
      tags:
        - Pipe
        - Unstackable

    # basic interactions
    - type: Clickable
    - type: InteractionOutline
    - type: Rotatable
    - type: Anchorable
    - type: Pullable
    - type: Physics
      bodyType: Static
    - type: Fixtures
      fixtures:
        fix1:
          shape:
            !type:PhysShapeAabb
            bounds: "-0.45,-0.45,0.45,0.45"
          density: 190
          mask:
            - MachineMask
          layer:
            - MachineLayer

    # functionality
    - type: NodeContainer
      nodes:
        inlet:
          !type:PipeNode
          nodeGroupID: Pipe
          pipeDirection: North
          volume: 100
        outlet:
          !type:PipeNode
          nodeGroupID: Pipe
          pipeDirection: South
          volume: 100
        circulator:
          !type:TegNodeCirculator
          nodeGroupID: Teg

    - type: AtmosUnsafeUnanchor
    - type: TegCirculator
