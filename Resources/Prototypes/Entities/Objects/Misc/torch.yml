- type: entity
  name: torch # todo: we need some sort of IgnitionSourceComponent we can add to this, so when it's lit it will cause fires when touching fuel
  parent: BaseItem
  id: Torch
  description: A torch fashioned from some wood.
  components:
    - type: ExpendableLight
      spentName: expendable-light-burnt-torch-name
      spentDesc: expendable-light-burnt-torch-desc
      glowDuration: 100
      fadeOutDuration: 4
      iconStateSpent: torch_spent
      turnOnBehaviourID: turn_on
      fadeOutBehaviourID: fade_out
      # Sounds legit nuff
      litSound:
        path: /Audio/Items/Flare/flare_on.ogg
    - type: Sprite
      sprite: Objects/Misc/torch.rsi
      layers:
        - map: [ enum.ExpendableLightVisualLayers.Base ]
          state: torch_unlit
        - map: [ enum.ExpendableLightVisualLayers.Glow ]
          state: lit_overlay
          color: "#FFFFFF"
          visible: false
          shader: unshaded
    - type: Icon
      sprite: Objects/Misc/torch.rsi
      state: icon
    - type: Item
      sprite: Objects/Misc/torch.rsi
      heldPrefix: unlit
    - type: Construction
      graph: LightTorch
      node: torch
    - type: Appearance
    - type: PointLight
      enabled: false
      color: "#E25822"
      radius: 1.0
      energy: 5.0
      netsync: false
    - type: IgnitionSource
      temperature: 400
      ignited: false
    - type: LightBehaviour
      behaviours:
        - !type:RandomizeBehaviour # immediately make it bright and flickery
          id: turn_on
          interpolate: Nearest
          minDuration: 0.02
          maxDuration: 0.06
          startValue: 6.0
          endValue: 9.0
          property: Energy
          isLooped: true
        - !type:FadeBehaviour # have the radius start small and get larger as it starts to burn
          id: turn_on
          maxDuration: 8.0
          startValue: 1.0
          endValue: 6.0
        - !type:RandomizeBehaviour # weaker flicker as it fades out
          id: fade_out
          interpolate: Nearest
          minDuration: 0.02
          maxDuration: 0.06
          startValue: 4.0
          endValue: 8.0
          property: Energy
          isLooped: true
        - !type:FadeBehaviour # fade out radius as it burns out
          id: fade_out
          maxDuration: 4.0
          startValue: 6.0
          endValue: 1.0

- type: entity
  name: candle
  parent: BaseItem
  id: Candle
  description: A thin wick threaded through fat.
  components:
    - type: Sprite
      noRot: true
      sprite: Objects/Misc/candles.rsi
      layers:
        - state: candle-big
    - type: Item
      size: 2
    - type: Fixtures
      fixtures:
        fix1:
          shape:
            !type:PhysShapeCircle
            radius: 0.35
          density: 20
          mask:
          - MobMask #so the candles can be put out with a fire extinguisher.
          layer:
          - MobLayer
    - type: Appearance
    - type: Reactive
      groups:
        Flammable: [ Touch ]
        Extinguish: [ Touch ]
    - type: ExtinguishOnInteract
      extinguishSound: 
        path: /Audio/Items/candle_blowing.ogg
        params:
          variation: 0.05
          volume: 10
    - type: UseDelay
    - type: Flammable
      fireSpread: false
      canResistFire: false
      alwaysCombustible: true
      canExtinguish: true 
      firestacksOnIgnite: 3.0
      firestackFade: 0.0 #the candle will not extinguish itself until it is destroyed.
      damage:
        types:
          Heat: 0.1
    - type: FireVisuals
      sprite: Objects/Misc/candles.rsi
      normalState: fire-big
    - type: ToggleableLightVisuals
      spriteLayer: Enum.FireVisuals.OnFire
      inhandVisuals:
        left:
        - state: inhand-left-flame
          shader: unshaded
        right:
        - state: inhand-right-flame
          shader: unshaded
    - type: Damageable
      damageModifierSet: Wood
    - type: Destructible
      thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 100
        behaviors:
        - !type:SpawnEntitiesBehavior
        - !type:DoActsBehavior
          acts: [ "Destruction" ]
          
- type: entity
  name: red candle
  parent: Candle
  id: CandleRed
  components:
  - type: Sprite
    layers:
      - state: candle-big
        color: "#a12349"

- type: entity
  name: blue candle
  parent: Candle
  id: CandleBlue
  components:
  - type: Sprite
    layers:
      - state: candle-big
        color: "#425d7d"

- type: entity
  name: black candle
  parent: Candle
  id: CandleBlack
  components:
  - type: Sprite
    layers:
      - state: candle-big
        color: "#1b1724"
        
- type: entity
  name: green candle
  parent: Candle
  id: CandleGreen
  components:
  - type: Sprite
    layers:
      - state: candle-big
        color: "#5d997e"  
        
- type: entity
  name: purple candle
  parent: Candle
  id: CandlePurple
  components:
  - type: Sprite
    layers:
      - state: candle-big
        color: "#984aa1"


- type: entity 
  name: small candle
  parent: Candle
  id: CandleSmall
  components:
    - type: Item
      size: 1
    - type: Sprite
      layers:
        - state: candle-small
          color: "#e2ca90"
    - type: FireVisuals
      normalState: fire-small
    - type: Flammable
      firestacksOnIgnite: 2.0
    - type: Destructible
      thresholds:
      - trigger:
          !type:DamageTrigger
          damage: 60
        behaviors:
        - !type:SpawnEntitiesBehavior
        - !type:DoActsBehavior
          acts: [ "Destruction" ]

- type: entity
  name: small red candle
  parent: CandleSmall
  id: CandleRedSmall
  components:
  - type: Sprite
    layers:
      - state: candle-small
        color: "#a12349"

- type: entity
  name: small blue candle
  parent: CandleSmall
  id: CandleBlueSmall
  components:
  - type: Sprite
    layers:
      - state: candle-small
        color: "#425d7d"

- type: entity
  name: small black candle
  parent: CandleSmall
  id: CandleBlackSmall
  components:
  - type: Sprite
    layers:
      - state: candle-small
        color: "#1b1724"
        
- type: entity
  name: small green candle
  parent: CandleSmall
  id: CandleGreenSmall
  components:
  - type: Sprite
    layers:
      - state: candle-small
        color: "#5d997e"  

- type: entity
  name: small purple candle
  parent: CandleSmall
  id: CandlePurpleSmall
  components:
  - type: Sprite
    layers:
      - state: candle-small
        color: "#984aa1"
#Purely decorative candles for mappers. Do not have any functionality.

- type: entity 
  name: magic candle 
  description: It's either magic or high tech, but this candle never goes out. On the other hand, its flame is quite cold.
  parent: BaseItem
  id: CandleInfinite
  components:
    - type: Sprite
      noRot: true
      sprite: Objects/Misc/candles.rsi
      layers:
        - state: candle-big
          color: "#decb8e"
        - state: fire-big
          shader: unshaded
    - type: PointLight
      color: "#e39c40"
      radius: 2.5
      power: 10
