# Specific Root compound tasks being used for NPCs.

# Tries to shoot a target in LOS in range.
- type: htnCompound
  id: TurretCompound
  branches:
    - tasks:
        - id: GunCombatCompound
    - tasks:
        - id: IdleSpinCompound

- type: htnCompound
  id: PirateCompound
  branches:
    # TODO: Equip a gun from inventory if one found, preferring over pickup.
    # Shoot if ammo
    - tasks:
        - id: GunCombatCompound
      preconditions:
        - !type:GunAmmoPrecondition
          minPercent: 0.001
    # Pickup ammo if any nearby
    # TODO: Need nearby ammo
    #- tasks:
    #    - id: GunAmmoPickupCompound
    #  preconditions:
    #    - !type:GunAmmoPrecondition
    #      maxPercent: 0.0
    # Discard gun if no ammo
    - tasks:
        - id: DiscardActiveHandPrimitive
      preconditions:
        - !type:ActiveHandComponentPrecondition
          components:
            - type: Gun
        - !type:GunAmmoPrecondition
          maxPercent: 0.001
    # Pickup gun if no ammo
    - tasks:
        - id: PickupGunCompound
      preconditions:
        - !type:ActiveHandComponentPrecondition
          components:
            - type: Gun
          invert: true


# Changes:
# Make melee combat and movement separate
# Melee just does the hit and then moves at the target.
# If target out of double melee range then fail.
