# Picks a random location for the NPC to move to and idle.
- type: htnCompound
  id: IdleCompound
  branches:
    - tasks:
        - !type:htnPrimitive
          operator: !type:WaitOperator
            key: IdleTime
          preconditions:
            - !type:KeyExistsPrecondition
              key: IdleTime
    # Pick a new spot and wait there.
    - tasks:
        - !type:htnPrimitive
          operator: !type:PickAccessibleOperator
            rangeKey: IdleRange
            targetKey: Target
        - !type:htnPrimitive
          operator: !type:MoveToOperator
            pathfindInPlanning: false
        - !type:htnPrimitive
          operator: !type:RandomOperator
            targetKey: IdleTime
            minKey: MinimumIdleTime
            maxKey: MaximumIdleTime
        - !type:htnPrimitive
          operator: !type:WaitOperator
            key: IdleTime
          preconditions:
            - !type:KeyExistsPrecondition
              key: IdleTime
      preconditions:
        - !type:BuckledPrecondition
          isBuckled: false
        - !type:PulledPrecondition
          isPulled: false

# Spin to a random rotation and idle.
- type: htnCompound
  id: IdleSpinCompound
  branches:
    - tasks:
        - !type:htnPrimitive
          operator: !type:WaitOperator
            key: IdleTime
          preconditions:
            - !type:KeyExistsPrecondition
              key: IdleTime
    # Pick a new angle and spin there
    - tasks:
        - !type:htnPrimitive
          operator: !type:PickRandomRotationOperator
            targetKey: RotateTarget
        - !type:htnPrimitive
          operator: !type:RotateToTargetOperator
            targetKey: RotateTarget
        - !type:htnPrimitive
          operator: !type:RandomOperator
            targetKey: IdleTime
            minKey: MinimumIdleTime
            maxKey: MaximumIdleTime
        - !type:htnPrimitive
          operator: !type:WaitOperator
            key: IdleTime
          preconditions:
            - !type:KeyExistsPrecondition
              key: IdleTime
