using Robust.Client.AutoGenerated;
using Robust.Client.GameObjects;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Prototypes;

namespace Content.Client.Clothing.UI;

[GenerateTypedNameReferences]
public sealed partial class ChameleonMenu : DefaultWindow
{
    [Dependency] private readonly IPrototypeManager _prototypeManager = default!;

    public ChameleonMenu(List<string> possibleIds)
    {
        RobustXamlLoader.Load(this);
        IoCManager.InjectDependencies(this);

        FillGrid(possibleIds);
    }

    private void FillGrid(List<string> possibleIds)
    {
        var spriteSys = EntitySystem.Get<SpriteSystem>();
        foreach (var id in possibleIds)
        {
            if (!_prototypeManager.TryIndex(id, out EntityPrototype? proto))
                continue;

            var texture = spriteSys.GetPrototypeIcon(proto);
            Grid.AddChild(new TextureRect()
            {
                Stretch = TextureRect.StretchMode.KeepAspect,
                MinSize = new Vector2(32, 32),
                Texture = texture.Default
            });
        }
    }
}
