using Content.Shared.Humanoid.Markings;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Humanoid;

// hack for a panel that modifies an entity's markings on demand

[GenerateTypedNameReferences]
public sealed partial class HumanoidMarkingModifierWindow : DefaultWindow
{
    public Action<MarkingSet>? OnMarkingAdded;
    public Action<MarkingSet>? OnMarkingRemoved;
    public Action<MarkingSet>? OnMarkingColorChange;
    public Action<MarkingSet>? OnMarkingRankChange;

    public HumanoidMarkingModifierWindow()
    {
        RobustXamlLoader.Load(this);

        MarkingPickerWidget.OnMarkingAdded += OnMarkingAdded;
        MarkingPickerWidget.OnMarkingRemoved += OnMarkingRemoved;
        MarkingPickerWidget.OnMarkingColorChange += OnMarkingColorChange;
        MarkingPickerWidget.OnMarkingRankChange += OnMarkingRankChange;
        MarkingForced.OnToggled += args => MarkingPickerWidget.Forced = args.Pressed;
        MarkingIgnoreSpecies.OnToggled += args => MarkingPickerWidget.Forced = args.Pressed;

        MarkingPickerWidget.Forced = MarkingForced.Pressed;
        MarkingPickerWidget.IgnoreSpecies = MarkingForced.Pressed;
    }

    public void SetMarkings(MarkingSet markings, string species, Color skinColor)
    {
        MarkingPickerWidget.SetData(markings, species, skinColor);
    }
}
