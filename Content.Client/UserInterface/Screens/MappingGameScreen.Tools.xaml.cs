using Content.Client.Decals;
using Content.Client.Mapping;
using Content.Client.Markers;
using Content.Client.NodeContainer;
using Content.Client.SubFloor;
using Content.Client.Viewport;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Sandboxing;

namespace Content.Client.UserInterface.Screens;

public sealed partial class MappingGameScreen : UIScreen
{
    [Dependency] private readonly ISandboxHelper _helper = default!;

    public void ActivateTool(Type toolType)
    {
        if (ActiveTool is not null)
        {
            ActiveTool.Shutdown();
        }

        var tool = (Tool) _helper.CreateInstance(toolType);
        var cfgControl = (Control) _helper.CreateInstance(tool.ToolConfigurationControl);
        ChildRemoved(ToolWidgetContainer);
        ToolWidgetContainer.RemoveAllChildren();
        ToolWidgetContainer.AddChild(cfgControl);
        SetAnchorPreset(cfgControl, LayoutPreset.HorizontalCenterWide);
        ChildAdded(ToolWidgetContainer);
        tool.Startup();
        ActiveTool = tool;
    }

    public void DeactivateTool()
    {
        ActiveTool?.Shutdown();
        ChildRemoved(ToolWidgetContainer);
        ToolWidgetContainer.RemoveAllChildren();
        ActiveTool = null;
    }

}
