using Content.Shared.Ghost.Roles;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Ghost.Roles.UI;

public sealed partial class GhostRoleGroupEntry : BaseEntry
{
    public event Action<GhostRoleGroupInfo>? OnGroupSelected;
    public event Action<GhostRoleGroupInfo>? OnGroupCancelled;

    public GhostRoleGroupEntry(GhostRoleGroupInfo group, bool isRequested)
    {
        var total = group.AvailableCount;
        var ready = group.Status == "Released";

        Title.Text = total > 1 ? $"{group.Name} ({total})" : group.Name;
        Description.SetMessage(group.Description);

        RequestButton.Text = "Request";

        TakeButton.Visible = false;
        FollowButton.Visible = false;
        RequestButton.Visible = ready && !isRequested;
        CancelButton.Visible = ready && isRequested;

        RequestButton.OnPressed += _ => OnGroupSelected?.Invoke(group);
        CancelButton.OnPressed += _ => OnGroupCancelled?.Invoke(group);
    }
}
